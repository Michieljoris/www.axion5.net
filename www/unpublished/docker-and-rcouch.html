<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" xmlns:ng="http://angularjs.org" lang="en"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" xmlns:ng="http://angularjs.org" lang="en"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" xmlns:ng="http://angularjs.org" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> 
<html class="no-js" xmlns:ng="http://angularjs.org" lang="en">
  <!--<![endif]-->
  <head id="head"><title>Axion5-Docker and rcouch</title><meta charset='utf-8'/><meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'/><meta content='' name='description'/><meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1'/>
<!--partial:html/ieshim.html--><!--[if lte IE 8]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <script>
      // The ieshiv takes care of our ui.directives, bootstrap module directives and 
      // AngularJS's ng-view, ng-include, ng-pluralize and ng-switch directives.
      // However, IF you have custom directives (yours or someone else's) then
      // enumerate the list of tags in window.myCustomTags

      window.myCustomTags = [ 'yourDirective', 'somebodyElsesDirective' ]; // optional
    </script>
    <script src="js/angular-ui-ieshiv.js"></script>
    <![endif]-->						    


<link rel="stylesheet" type="text/css" href="/css/bower/normalize.css/normalize.css">
<link rel="stylesheet" type="text/css" href="/css/bower/bootstrap/dist/css/bootstrap.css">
<link rel="stylesheet" type="text/css" href="/css/tweak.css">
<link rel="stylesheet" type="text/css" href="/css/highlightjs/hybrid.css">
<link rel="stylesheet" type="text/css" href="/css/blog.css">
<link rel="stylesheet" type="text/css" href="/css/main.css">

<script type='text/javascript'>function cachify(path) { return path; }</script><!--partial:html/google_analytics.html--><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27130001-2', 'auto');
  ga('send', 'pageview');

</script>
</head>
  <body id="body" ><!--partial:html/body-blog.html--><!--[if lt IE 7]>
    <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

<!-- <div class="row"> -->
<div id="editbar--" > </div>
<!-- </div> -->


<div class="blog-masthead">
  <div class="container">
    <nav class="blog-nav">
      <a id="menu-blog" class="blog-nav-item" href="/">Blog</a>
      <a id="menu-projects" class="blog-nav-item" href="/projects.html">Projects</a>
      <a id="menu-websites" class="blog-nav-item" href="/websites.html">Websites</a>
      <a id="menu-aboutme" class="blog-nav-item" href="/aboutme.html">About me</a>
      <a id="site-title" href="/">Axion5</a>
    </nav>
  </div>
</div>

<div id="main" class="container">

  <div class="blog-header">
    <h1 class="blog-title">Axion5</h1>
    <p class="lead blog-description">The official example template of creating a blog with Bootstrap.</p>
  </div>

  <div align="justify" id="blog-body" class="row">

    <div class="col-sm-9 blog-main">

      <div class="pageTitle" id="pageTitle--"><header >
  <div class="title blog-post-title">  Docker and rcouch  </div>
  <time class="blog-post-meta" datetime="24th of December 2014">  24th of December 2014  </time>
</header></div>
      <div  id="main--" class="blog-post"><!--partial:post/Docker and rcouch.org--><div id="toc"><ul><li><a href="#header-1"><span class="section-number">1</span>rcouch</a></li>
<li><a href="#header-2"><span class="section-number">2</span>docker mini manual</a><ul><li><a href="#header-2-1"><span class="section-number">2.1</span>docker ui  </a></li>
<li><a href="#header-2-2"><span class="section-number">2.2</span>no sshd in container!!!?!!   </a></li>
<li><a href="#header-2-3"><span class="section-number">2.3</span>share dir between host and container</a></li>
<li><a href="#header-2-4"><span class="section-number">2.4</span>Run a script in container</a></li>
<li><a href="#header-2-5"><span class="section-number">2.5</span>Run shell</a></li>
<li><a href="#header-2-6"><span class="section-number">2.6</span>Run deamonized script</a></li>
<li><a href="#header-2-7"><span class="section-number">2.7</span>Run image with name</a></li>
<li><a href="#header-2-8"><span class="section-number">2.8</span>mount volume from host in container</a></li>
<li><a href="#header-2-9"><span class="section-number">2.9</span>List all containers</a></li>
<li><a href="#header-2-10"><span class="section-number">2.10</span>display container stdout</a></li>
<li><a href="#header-2-11"><span class="section-number">2.11</span>stop running container   </a></li>
<li><a href="#header-2-12"><span class="section-number">2.12</span>restart container</a></li>
<li><a href="#header-2-13"><span class="section-number">2.13</span>copy file to host</a></li>
<li><a href="#header-2-14"><span class="section-number">2.14</span>details of last containter started</a></li>
<li><a href="#header-2-15"><span class="section-number">2.15</span>expose any required network ports inside our container to our host</a></li>
<li><a href="#header-2-16"><span class="section-number">2.16</span>map to specific port </a></li>
<li><a href="#header-2-17"><span class="section-number">2.17</span>find public facing port   </a></li>
<li><a href="#header-2-18"><span class="section-number">2.18</span>top processes in container:</a></li>
<li><a href="#header-2-19"><span class="section-number">2.19</span>inspect container</a></li>
<li><a href="#header-2-20"><span class="section-number">2.20</span>getting a new image</a></li>
<li><a href="#header-2-21"><span class="section-number">2.21</span>searching for an image</a></li>
<li><a href="#header-2-22"><span class="section-number">2.22</span>commiting a new image</a></li>
<li><a href="#header-2-23"><span class="section-number">2.23</span>a container is an image on which you have executed commands and</a></li>
<li><a href="#header-2-24"><span class="section-number">2.24</span>or create a new image from a Dockerfile:</a></li>
<li><a href="#header-2-25"><span class="section-number">2.25</span>set a new tag on a image:</a></li>
<li><a href="#header-2-26"><span class="section-number">2.26</span>Dockerfile CMD ENTRYPOINT</a></li>
<li><a href="#header-2-27"><span class="section-number">2.27</span>To show command history of a image.</a></li>
</ul>
</li>
</ul>
</div><pre>comments: false
published: false
title: Docker and rcouch
tags: docker, rcouch, couchdb</pre>
<h2 id="header-1"><span class="section-number">1</span>rcouch</h2>
apt-get updatesudo apt-get install build-essential checkinstallcd /hostdpkg -i esl-erlang_15.b~ubuntu~oneiric_amd64.debapt-get -f installgit clone git://<a href="http://github.com/rebar/rebar.git">http://github.com/rebar/rebar.git</a>cd rebar/./bootstrap cp rebar /binapt-get install gitsudo apt-get install curlapt-get install zipapt-get install icu-devtoolsapt-get install libicu-devapt-get install libcurl4-gnutls-devgit clone <a href="https://github.com/rcouch/rcouch.git">https://github.com/rcouch/rcouch.git</a><p>cd rcouch/
make
make rel
rel/rcouch/bin/rcouch start
<a href="https://groups.google.com/forum/#!topic/rcouch/k2Fo3FZlB3U">https://groups.google.com/forum/#!topic/rcouch/k2Fo3FZlB3U</a></p>
<p></p>
<h2 id="header-2"><span class="section-number">2</span>docker mini manual</h2>
<a href="https://github.com/wsargent/docker-cheat-sheet">https://github.com/wsargent/docker-cheat-sheet</a><h3 id="header-2-1"><span class="section-number">2.1</span>docker ui  </h3>
Manage docker containers and images with a webpage:<a href="https://github.com/crosbymichael/dockerui">https://github.com/crosbymichael/dockerui</a>Quickstart:<pre>build -t crosbymichael/dockerui <a href="http://github.com/crosbymichael/dockerui">http://github.com/crosbymichael/dockerui</a>
docker run -d -p 9000:9000 -v /var/run/docker.sock:/docker.sock crosbymichael/dockerui -e /docker.sock</pre>
Open your browser to <a href="http://&#60;dockerd">http://&#60;dockerd</a> host ip&#62;:9000<h3 id="header-2-2"><span class="section-number">2.2</span>no sshd in container!!!?!!   </h3>
<a href="http://jpetazzo.github.io/2014/06/23/docker-ssh-considered-evil/">http://jpetazzo.github.io/2014/06/23/docker-ssh-considered-evil/</a>but use <a href="https://github.com/jpetazzo/nsenter">https://github.com/jpetazzo/nsenter</a>To install:<pre>docker run --rm -v /usr/local/bin:/target jpetazzo/nsenter</pre>
Use the docker-enter script, put it in ~/bin, download it here:<a href="https://github.com/jpetazzo/nsenter/raw/master/docker-enter">https://github.com/jpetazzo/nsenter/raw/master/docker-enter</a>To enter any docker image:<pre>docker-enter &#60;imagename&#62;</pre>
<h3 id="header-2-3"><span class="section-number">2.3</span>share dir between host and container</h3>
docker run -d --name phusion -v /home/michieljoris/tmp:/host phusion/baseimage  <h3 id="header-2-4"><span class="section-number">2.4</span>Run a script in container</h3>
sudo docker run ubuntu:14.04 /bin/echo &#39;Hello world&#39;Runs then stops<h3 id="header-2-5"><span class="section-number">2.5</span>Run shell</h3>
sudo docker run -t -i ubuntu:14.04 /bin/bashThe -t flag assigns a pseudo-tty or terminal inside our new container and the -iflag allows us to make an interactive connection by grabbing the standard in(STDIN) of the container.<h3 id="header-2-6"><span class="section-number">2.6</span>Run deamonized script</h3>
sudo docker run -d ubuntu:14.04 /bin/sh -c &#34;while true; do echo hello world; sleep 1; done&#34;<h3 id="header-2-7"><span class="section-number">2.7</span>Run image with name</h3>
docker run -d --name phusion phusion/baseimage <h3 id="header-2-8"><span class="section-number">2.8</span>mount volume from host in container</h3>
docker run -v /home/vagrant/test:/root/test ubuntu echo yo<h3 id="header-2-9"><span class="section-number">2.9</span>List all containers</h3>
docker ps -a<h3 id="header-2-10"><span class="section-number">2.10</span>display container stdout</h3>
docker logs &#60;docker name or id&#62;docker logs -f &#60;docker name or id&#62;-f for the tail<h3 id="header-2-11"><span class="section-number">2.11</span>stop running container   </h3>
docker stop &#60;id or name&#62; <h3 id="header-2-12"><span class="section-number">2.12</span>restart container</h3>
docker restart &#60;id or name&#62;<h3 id="header-2-13"><span class="section-number">2.13</span>copy file to host</h3>
docker cp &#60;id or name&#62;:/etc/passwd .<h3 id="header-2-14"><span class="section-number">2.14</span>details of last containter started</h3>
docker ps -l<h3 id="header-2-15"><span class="section-number">2.15</span>expose any required network ports inside our container to our host</h3>
use -P flag:docker run -d -P training/webapp python app.py<h3 id="header-2-16"><span class="section-number">2.16</span>map to specific port </h3>
docker run -d -p 5000:5000 training/webapp python app.pyor docker run -d -p 5000 training/webapp python app.pyto bind 5000 inside to open port outside<h3 id="header-2-17"><span class="section-number">2.17</span>find public facing port   </h3>
docker port &#60;id or name&#62; 5000to what port is inside port 5000 bound on the host<h3 id="header-2-18"><span class="section-number">2.18</span>top processes in container:</h3>
docker top &#60;id or name&#62;<h3 id="header-2-19"><span class="section-number">2.19</span>inspect container</h3>
docker inspect &#60;id or name&#62;<h3 id="header-2-20"><span class="section-number">2.20</span>getting a new image</h3>
docker pull centos<h3 id="header-2-21"><span class="section-number">2.21</span>searching for an image</h3>
docker search sinatra<h3 id="header-2-22"><span class="section-number">2.22</span>commiting a new image</h3>
Start an image, start shell or ssh in, do your changes    docker commit -m=&#34;Added json gem&#34; -a=&#34;Kate Smith&#34; \0b2616b0e5a8 ouruser/sinatra:v2where 0b261... is a container just started -a is author and name of newimage is ouruser/sinatra:v2<h3 id="header-2-23"><span class="section-number">2.23</span>a container is an image on which you have executed commands and</h3>
these can be commited again to an image!! <h3 id="header-2-24"><span class="section-number">2.24</span>or create a new image from a Dockerfile:</h3>
FROM ubuntu:14.04MAINTAINER Kate Smith &#60;ksmith@example.com&#62;RUN apt-get update &#38;&#38; apt-get install -y ruby ruby-devRUN gem install sinatraThen in dir of Dockerfile:docker build -t=&#34;ouruser/sinatra:v2&#34; .We can then create a container from our new image.docker run -t -i ouruser/sinatra:v2 /bin/bash<h3 id="header-2-25"><span class="section-number">2.25</span>set a new tag on a image:</h3>
docker tag 5db5f8471261 ouruser/sinatra:devel<h3 id="header-2-26"><span class="section-number">2.26</span>Dockerfile CMD ENTRYPOINT</h3>
ENTRYPOINT [&#34;/usr/bin/rethinkdb&#34;]CMD [&#34;--help&#34;]With the ENTRYPOINT set, we know that whenever this image is run, all argumentspassed during docker run will be arguments to the ENTRYPOINT (/usr/bin/rethinkdb ).<p>I also have a default CMD set in the Dockerfile to --help. What this does is
incase no arguments are passed during docker run, rethinkdb&#39;s default help
output will display to the user. This is same functionality that you would
expect interacting with the rethinkdb binary.</p>
<h3 id="header-2-27"><span class="section-number">2.27</span>To show command history of a image.</h3>
docker history tcnksm/hello</div>
      <div  id="page--" class="page"> </div>
      <div  id="disqus-embed--"> </div>
      <div  id="disqus-count--"> </div>

    </div><!-- /.blog-main -->

    <div id="rightbar--" class="box col-sm-3 col-sm-offset-1 blog-sidebar"><!--partial:html/search.html--><div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:www.axion5.net">
  </form>
</div>
<!--partial:html/aboutmeWidgetWrapper.html--><div align="justify" class="widget sidebar-module sidebar-module-inset">
  <div id="widget--"><!--partial:widgets/aboutmeWidget.org--><div id="toc"><ul></ul>
</div><h5 id="header-0-0-0-1"><span class="section-number">0.0.0.1</span>About me </h5>
<p>Dutch by birth, living in Australia since late youth, classical pianist, but 
closet programmer since childhood. This site hopefully is able to showcase some 
of my more useful fabrications and thoughts.</p>
<p>All my code is on <a href="http://github.com/michieljoris">github</a>. </p>
<p>For more info see the <a href="/aboutme.html">about me</a> page, <a href="http://au.linkedin.com/in/michieljoris/">linkedin</a> or 
<a href="http://careers.stackoverflow.com/michieljoris">stackoverflow</a>.</p>
<p>Email me at <a href="mailto:mail@axion5.net">mail@axion5.net</a></p>
</div>
</div>

<!--partial:html/recentWidgetWrapper.html--><div class="widget sidebar-module">
  <b>Recent posts</b>
  <div id="widget--"><ul id="most-recent-partial">
  <li><a href="/post/the-web-is-not-a-good-fit-really.html">The web is not a good fit really..</a></li>
  <li><a href="/post/my-webstack.html">My webstack</a></li>
  <li><a href="/post/meteor-docs-and-attached-files.html">Meteor, docs and attached files</a></li>
  <li><a href="/post/about-this-site.html">About this site</a></li>
  <li><a href="/post/markup-cheat-sheet-for-org-mode.html">Markup Cheat sheet for Org-mode</a></li>
</ul></div>
</div>
<!--partial:html/tagWidgetWrapper.html--><div class="widget sidebar-module ">
  <b>Tags</b>
  <div id="widget--"><ul id="by-tag-partial">
  <li><a href="/tag/database">database</a> (1)</li>
  <li><a href="/tag/Emacs">Emacs</a> (1)</li>
  <li><a href="/tag/ClojureScript">ClojureScript</a> (1)</li>
  <li><a href="/tag/install">install</a> (1)</li>
  <li><a href="/tag/Meteor">Meteor</a> (1)</li>
</ul></div>
</div>
<!--partial:html/archiveWidgetWrapper.html--><div class="widget sidebar-module">
  <b>Archive</b>
  <div id="widget--"><ul class="css-treeview" id="archive-partial">
 <li><a  href="/archive/2014" >2014</a>
  <ul>
   <li><a  href="/archive/2014/April" >April</a>
    <ul>
     <li><a  href="/post/my-webstack.html" >My webstack</a></li>
    </ul>
   </li>
   <li><a  href="/archive/2014/June" >June</a>
    <ul>
     <li><a  href="/post/meteor-docs-and-attached-files.html" >Meteor, docs and attached files</a></li>
    </ul>
   </li>
   <li><a  href="/archive/2014/October" >October</a>
    <ul>
     <li><a  href="/post/markup-cheat-sheet-for-org-mode.html" >Markup Cheat sheet for Org-mode</a></li>
     <li><a  href="/post/about-this-site.html" >About this site</a></li>
    </ul>
   </li>
   <li><a  href="/archive/2014/November" >November</a>
    <ul>
     <li><a  href="/post/installing-and-using-clojure-and-clojurescript-with-emacs.html" >Installing and using Clojure and ClojureScript with Emacs</a></li>
    </ul>
   </li>
   <li><a  href="/archive/2014/December" >December</a>
    <ul>
     <li><a  href="/post/the-web-is-not-a-good-fit-really.html" >The web is not a good fit really..</a></li>
    </ul>
   </li>
  </ul>
 </li>
</ul></div>
</div>
</div><!-- /.blog-sidebar -->

  </div><!-- /.row -->

</div><!-- /.container -->

<div class="blog-footer">
  <p>Site rendered from org files using 
<a href="http://github.com/michieljoris/bb-blog">bb-blog</a> and
    <a href="http://github.com/michieljoris/html-builder">html-builder</a>
    by <a href="https://github.com/michieljoris">@michieljoris</a>.</p>
  <p>
    <a href="#">Back to top</a>
  </p>
</div>

<script type="text/javascript" src="/scripts/bower/jquery/dist/jquery.js"></script>
<script type="text/javascript" src="/scripts/bower/bootstrap/dist/js/bootstrap.js"></script>
<script type="text/javascript" src="/scripts/bower/modernizr/modernizr.js"></script>
<script type="text/javascript" src="/scripts/bower/logthis/logthis.js"></script>
<script type="text/javascript" src="/scripts/highlight.pack.js"></script>
<script type="text/javascript" src="/scripts/main.js"></script>
<script>hljs.initHighlightingOnLoad();</script></body>
</html>	
	 
